<!DOCTYPE html>
<body>
<p>Build a trivial GL program. Nothing will appear on the viewport.
<canvas id=canvas>
<script>
// Set up the gl context
var gl = document.getElementById("canvas").getContext("webgl")
gl.canvas.width = 854
gl.canvas.height = 480
gl.viewport(0, 0, 854, 480)

// Create a program object
var prog = gl.createProgram()

// Output: true
console.log("Is this a program object:", gl.isProgram(prog))
// Output: ""
console.log("Program info log:", gl.getProgramInfoLog(prog))

// Create a vertex shader object
var vshader = gl.createShader(gl.VERTEX_SHADER)
// Output: true
console.log("Is this a shader object:", gl.isShader(vshader))
// Output: a GLenum equal to gl.VERTEX_SHADER
console.log("Shader type (should equal %d): %d", gl.VERTEX_SHADER, gl.getShaderParameter(vshader, gl.SHADER_TYPE))
// Set the source code for the shader
gl.shaderSource(vshader, "void main() { gl_Position = vec4(0.0); }")
// Output: the source code for this shader
console.log("Vertex shader source code:", gl.getShaderSource(vshader))
// Compile the shader
gl.compileShader(vshader)
// Output: true
console.log("Vertex shader compile status:", gl.getShaderParameter(vshader, gl.COMPILE_STATUS))
// Output: ""
console.log("Vertex shader info log:", gl.getShaderInfoLog(vshader))
// If compilation fails, it won't throw an error. You need to check the compilation status yourself
// and if it's false, throw an error that includes the info log.
if (!gl.getShaderParameter(vshader, gl.COMPILE_STATUS)) {
	throw "Error compiling vertex shader:\n" + gl.getShaderInfoLog(vshader)
}
// Attach the shader to the program
gl.attachShader(prog, vshader)
// Explicitly delete the shader. Usually unnecessary.
gl.deleteShader(vshader)

// Similarly create, compile, and attach a fragment shader
var fshader = gl.createShader(gl.FRAGMENT_SHADER)
gl.shaderSource(fshader, "void main() { }")
gl.compileShader(fshader)
// Check compilation status for the fragment shader too.
if (!gl.getShaderParameter(fshader, gl.COMPILE_STATUS)) {
	throw "Error compiling fragment shader:\n" + gl.getShaderInfoLog(fshader)
}
gl.attachShader(prog, fshader)

// Output: 2
console.log("Number of attached shaders:", gl.getProgramParameter(prog, gl.ATTACHED_SHADERS))
// Output: an Array of the two attached shaders
console.log("The attached shaders:", gl.getAttachedShaders(prog))

// Once a vertex and fragment shader are both attached, link the program.
gl.linkProgram(prog)
// Output: true
console.log("Program link status:", gl.getProgramParameter(prog, gl.LINK_STATUS))
// Throw an error if linking failed.
if (!gl.getProgramParameter(prog, gl.LINK_STATUS)) {
	throw "Error linking program:\n" + gl.getProgramInfoLog(prog)
}

// Optional: validate the program.
gl.validateProgram(prog)
// Output: true
console.log("Program validation status:", gl.getProgramParameter(prog, gl.VALIDATE_STATUS))
// Throw an error if validation failed.
if (!gl.getProgramParameter(prog, gl.VALIDATE_STATUS)) {
	throw "Program validation error:\n" + gl.getProgramInfoLog(prog)
}

gl.useProgram(prog)

// Explicitly delete the program. Usually unnecessary.
gl.deleteProgram(prog)
// Output: true
console.log("Program delete status:", gl.getProgramParameter(prog, gl.DELETE_STATUS))

</script>

